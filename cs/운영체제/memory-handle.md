# 메모리 관리 전략
## 메모리를 왜 관리해?
- 각각의 프로세스가 독립된 메모리 공간을 가지고, 운영체제 혹은 다른 프로세스의 메모리 공간에 접근할수 없는 제한이 걸려있다. 운영체제만이 운영체제 메모리영역과 사용자 메모리 영역의 접근에 제약을 받지 않으면서 메모리를 관리할 수 있다.

## Swapping
- 메모리 관리를 위해서 사용되는 기법이다.
- 메모리가 할당된 프로세스가 너무 많거나 CPU할당시간이 끝난 프로세스의 메모리를 보조 기억장치(하드디스크 등)으로 내보내고 다른 프로세스의 메모리를 불러들일 수 있다.

    > 이러한 과정을 swap이라고 한다. 주 기억장치(RAM)으로 불러오는 과정을 swap-in이라 하고, 디스크로 내보내는 것을 swap-out이라고 한다.
    > swap에는 소요시간이 많이 들어가기 때문에 현재는 메모리공간이 부족할때 주로 수행한다.

## 단편화(Fragmentation)
- 프로세스들이 메모리에 적재되고 삭제되다보면 메모리 공간 사이사이에 자유공간들이 늘어나게 되는데 이것을 단편화(Fragmentation)이라고 부른다. 단편화에는 두가지 종류가 있다.

    |`A 프로세스`|free|`B 프로세스`|free|`C 프로세스`|free|`D 프로세스`|
    |:-:|:-:|:-:|:-:|:-:|:-:|:-:|

    - `외부단편화`: RAM에서 사용하지 못하게 되는 부분들을 모두 합치면 충분한 공간이 되는 부분들이 분산되어있는 경우를 말한다.
    - `내부단편화`: **프로세스가 사용하는** 메모리 공간에 포함된 남는 부분을 말한다.

- 해결책: compaction(압축)
    - 외부 단편화를 해소하기 위해서 프로세스가 사용하는 메모리 공간을 한쪽으로 몰아서 자유공간을 확보하는 방법이다.
    - 작업 효율이 좋지 않다는 단점이 있다.

    |`A 프로세스`|`B 프로세스`|`C 프로세스`|`D 프로세스`|free|free|free|
    |:-:|:-:|:-:|:-:|:-:|:-:|:-:|

## Paging(페이징)
- 하나의 프로세스가 사용하는 메모리 공간이 연속이어야 한다는 제약을 없애버린 메모리 관리 기법이다.
- 앞에서 본 외부단편화와 압축 작업을 해소하기 위해서 생긴 방법론이다.
- 물리메모리는 `frame`이라는 고정 크기로 분리되어있고, 논리메모리는 `page`라고 불리는 고정크기의 **블록**으로 분리된다.
- 페이징 기법을 사용해서 논리 메모리가 물리메모리에 저장될 때 연속되어 저장될 필요가 없어진다. 물리메모리의 남는 공간에 적절하게 배치됨으로써 외부 단편화를 해결할 수 있다는 큰 장점이 있다.
- 하지만 내부단편화 문제의 비중이 늘어난다는 단점이 있다.

## Segmentation(세그멘테이션)
- 페이징이 프로세스의 메모리 공간을 물리적으로 일정한 길이로 나눈 것이라면 세그먼트는 프로세스의 논리적인 내용을 기반으로 해서 메모리에 배치한다. 세그먼트의 길이는 일반적으로 같지 않다.
- 세그먼트 번호 + 변위, 세그먼트 테이블에는 각 세그먼트의 기준(세그먼트의 시작 물리주소)와 한계(세그먼트의 길이)를 저장한다.
- 서로 다른 크기의 세그먼트 들이 메모리에 적재되고 삭제되는 일이 반복되다 보면, 자유공간이 많아져 외부단편화가 일어날 수 있다.
- 세그먼트의 크기는 일정하지 않기 때문에 limit가 주어진다. 이 세그먼트의 크기를 넘어서는 주소가 들어오면 인터럽트가 발생해서 해당 프로세스를 강제로 종료시킨다.
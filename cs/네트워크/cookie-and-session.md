# 쿠키와 세션

쿠키와 세션 둘다 HTTP 프로토콜의 특징인 비 연결성과 비 상태성이라는 특징 때문에 필요해 졌습니다.
HTTP 프로토콜은 모든 요청간에 의존관계가 없어서 현재 접속해 있는 클라이언트가 이전에 접속했던 클라이언트와 같은 클라이언트인지 알 수 있는 방법이 없습니다.
또한 연결을 유지하지 않는다는 점은 불필요한 리소스를 낭비하지 않는다는 장점이 있지만 통신할 때마다 새로 연결해야 되기 때문에 클라이언트에서 매번 인증과정을 거쳐야한다는 단점이 있습니다. 따라서 HTTP 프로토콜의 상태를 유지해야할 필요성이 생겼고, 이에 쿠키와 세션개념이 등장하였습니다.

쿠키는 클라이언트의 상태정보를 브라우저에 저장하여 참조합니다. name, value등이 저장되어있는 하나의 파일입니다.
- 웹 브라우저가 서버에 작업을 요청합니다.
- 그러면 상태를 유지하고 싶은 값에 대해 쿠키를 생성합니다.
- 서버측에서 HTTP 헤더에 쿠키를 포함해서 전송해주고
- 전달받은 쿠키는 웹 브라우저에 저장되었다가 다음 HTTP 요청때 헤더에 담겨서 서버에 전송됩니다.
- 서버는 쿠키를 읽어서 이전 상태를 확인한 후 응답하게 됩니다.

방문했던 웹 사이트에 대한 정보 및 개인정보가 기록되기 때문에 사생활 침해 문제가 있을 수 있고 서버에 저장되는 것이 아니라 브라우저에 저장되는 것이기 때문에 임의 수정이 가능하여 보안에 취약하다는 특징이 있습니다.

세션은 서버에서 일정시간동안 같은 브라우저에 들어오는 요청을 하나로 보고 그 상태를 유지하는 기술입니다. 즉 웹 브라우저를 통해 서버에 접속한 이후부터 브라우저를 종료할 때까지 유지되는 상태입니다.
- SessionID로 구분됩니다. SessionID는 브라우저당 하나씩 생성되고 브라우저 종료시에 소멸됩니다.
- ID, Password등 필요한 정보를 세션에 담아두면 요청이 있을 때마다 DB에 접근할 필요가 없어지기 때문에 효율적입니다.

동작방식은
- 웹 브라우저가 서버에 요청을합니다.
- 서버가 해당 웹 브라우저에 유일한 ID를 부여하게 됩니다.
- 서버가 응답할 때 HTTP 헤더 중에서 setCookie라는 헤더에 SessionID를 포함하여 전송합니다.
- 웹 브라우저가 이후에 서버에게 요청을 보낼 때마다 SessionID가 담겨있는 쿠키를 HTTP의 헤더에 넣어서 전송합니다.
- 서버는 SessionID를 확인하고, 해당 세션에 관련된 정보를 확인한 후 응답합니다.

세션도 쿠키를 사용해서 값을 주고받습니다. 다시 말해서 상태정보를 유지하는 수단은 쿠키이고, 세션은 쿠키를 사용하는 또다른 방식인 것입니다.